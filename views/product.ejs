<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= typeof title !== 'undefined' ? title : 'Kinetic Constructs' %></title>
    <link rel="stylesheet" href="/css/style.css">
    <% if (typeof productAssistantUrl !== 'undefined' && productAssistantUrl) { %>
    <link rel="stylesheet" href="/css/chatbot-widget.css">
    <% } %>
</head>
<body>
    <%- include('partials/header') %>

    <main>
        <%- include('partials/product-main', {
            product: typeof product !== 'undefined' ? product : null,
            error: typeof error !== 'undefined' ? error : null, // Pass error too, if product-main handles it
            searchParams: typeof searchParams !== 'undefined' ? searchParams : {},
            initialDocId: typeof initialDocId !== 'undefined' ? initialDocId : '',
            initialDocTitle: typeof initialDocTitle !== 'undefined' ? initialDocTitle : '',
            initialDocContent: typeof initialDocContent !== 'undefined' ? initialDocContent : ''
        }) %>
    </main>

    <%- include('partials/footer') %>

    <script src="<%= script %>"></script> <%# Include script passed from route %>

    <% if (typeof productAssistantUrl !== 'undefined' && productAssistantUrl) { %>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <%- include('partials/chatbot-widget') %>

    <script>
        const productAssistantUrl = '<%= productAssistantUrl %>';
    </script>
    <script src="/js/chatbot-widget.js"></script>
    <% } %>
</body>
</html> 